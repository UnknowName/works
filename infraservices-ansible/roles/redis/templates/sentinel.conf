{% for host in groups['redis'] %}
daemonize no
port 26379
#指定工作目录
dir "/data/sentinel/sentinel-work"
#1表示在sentinel集群中只要有两个节点检测到redis主节点出故障就进行切换，单sentinel节点无效(自己测试发现的)
#如果3s内mymaster无响应，则认为mymaster宕机了
#如果10秒后,mysater仍没活过来，则启动failover
{%- if hostvars[host]['role'] == 'master' -%}
    {% set master_ip=hostvars[host]['ansible_default_ipv4']['address'] %}
sentinel monitor mymaster {{ master_ip }} 6379 1
{% endif %}
sentinel down-after-milliseconds mymaster 3000
sentinel failover-timeout mymaster 10000
protected-mode no
#redis主节点密码
sentinel auth-pass mymaster {{ REDIS_AUTH|default('redis.123') }}
{% endfor %}
